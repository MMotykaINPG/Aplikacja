#pragma once
 
namespace Apka {
 
    using namespace System;
    using namespace System::ComponentModel;
    using namespace System::Collections;
    using namespace System::Windows::Forms;
    using namespace System::Data;
    using namespace System::Drawing;
 
    /// <summary>
    /// Summary for Form1
    /// </summary>
    public ref class Form1 : public System::Windows::Forms::Form
    {
    public:
        Form1(void)
        {
            InitializeComponent();
            //
            //TODO: Add the constructor code here
            //
        }
 
    protected:
        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        ~Form1()
        {
            if (components)
            {
                delete components;
            }
        }
 
    private: System::Windows::Forms::Button^  btnPlay;
    private: System::Windows::Forms::Button^  btnStop;
 
 
 
 
 
    private: AxWMPLib::AxWindowsMediaPlayer^  axWindowsMediaPlayer1;
    private: System::Windows::Forms::Button^  btnPause;
 
    public: System::Windows::Forms::Timer^  ProgresTimer;
    private:
 
    public:
    private: System::Windows::Forms::TrackBar^  trackBarProgress;
    public:
    private:
    private: System::ComponentModel::IContainer^  components;
    public:
 
    protected:
 
    private:
        /// <summary>
        /// Required designer variable.
        /// </summary>
 
 
#pragma region Windows Form Designer generated code
        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        void InitializeComponent(void)
        {
            this->components = (gcnew System::ComponentModel::Container());
            System::ComponentModel::ComponentResourceManager^  resources = (gcnew System::ComponentModel::ComponentResourceManager(Form1::typeid));
            this->btnPlay = (gcnew System::Windows::Forms::Button());
            this->btnStop = (gcnew System::Windows::Forms::Button());
            this->axWindowsMediaPlayer1 = (gcnew AxWMPLib::AxWindowsMediaPlayer());
            this->btnPause = (gcnew System::Windows::Forms::Button());
            this->ProgresTimer = (gcnew System::Windows::Forms::Timer(this->components));
            this->trackBarProgress = (gcnew System::Windows::Forms::TrackBar());
            (cli::safe_cast<System::ComponentModel::ISupportInitialize^  >(this->axWindowsMediaPlayer1))->BeginInit();
            (cli::safe_cast<System::ComponentModel::ISupportInitialize^  >(this->trackBarProgress))->BeginInit();
            this->SuspendLayout();
            //
            // btnPlay
            //
            this->btnPlay->Location = System::Drawing::Point(13, 531);
            this->btnPlay->Name = L"btnPlay";
            this->btnPlay->Size = System::Drawing::Size(82, 40);
            this->btnPlay->TabIndex = 1;
            this->btnPlay->Text = L"Play";
            this->btnPlay->UseVisualStyleBackColor = true;
            this->btnPlay->Click += gcnew System::EventHandler(this, &Form1::btnPlay_Click);
            //
            // btnStop
            //
            this->btnStop->Location = System::Drawing::Point(101, 530);
            this->btnStop->Name = L"btnStop";
            this->btnStop->Size = System::Drawing::Size(82, 40);
            this->btnStop->TabIndex = 2;
            this->btnStop->Text = L"Stop";
            this->btnStop->UseVisualStyleBackColor = true;
            this->btnStop->Click += gcnew System::EventHandler(this, &Form1::btnStop_Click);
            //
            // axWindowsMediaPlayer1
            //
            this->axWindowsMediaPlayer1->Enabled = true;
            this->axWindowsMediaPlayer1->Location = System::Drawing::Point(1, 22);
            this->axWindowsMediaPlayer1->Name = L"axWindowsMediaPlayer1";
            this->axWindowsMediaPlayer1->OcxState = (cli::safe_cast<System::Windows::Forms::AxHost::State^  >(resources->GetObject(L"axWindowsMediaPlayer1.OcxState")));
            this->axWindowsMediaPlayer1->Size = System::Drawing::Size(640, 480);
            this->axWindowsMediaPlayer1->TabIndex = 0;
            //
            // btnPause
            //
            this->btnPause->Location = System::Drawing::Point(189, 530);
            this->btnPause->Name = L"btnPause";
            this->btnPause->Size = System::Drawing::Size(82, 40);
            this->btnPause->TabIndex = 3;
            this->btnPause->Text = L"Pause";
            this->btnPause->UseVisualStyleBackColor = true;
            this->btnPause->Click += gcnew System::EventHandler(this, &Form1::btnPause_Click);
            //
            // ProgresTimer
            //
            this->ProgresTimer->Enabled = true;
            this->ProgresTimer->Interval = 1;
            this->ProgresTimer->Tick += gcnew System::EventHandler(this, &Form1::ProgresTimer_Tick);
            //
            // trackBarProgress
            //
            this->trackBarProgress->Location = System::Drawing::Point(30, 507);
            this->trackBarProgress->Name = L"trackBarProgress";
            this->trackBarProgress->Size = System::Drawing::Size(488, 56);
            this->trackBarProgress->TabIndex = 6;
            this->trackBarProgress->TickFrequency = 0;
            this->trackBarProgress->Scroll += gcnew System::EventHandler(this, &Form1::trackBarProgress_Scroll);
            //
            // Form1
            //
            this->AutoScaleDimensions = System::Drawing::SizeF(8, 16);
            this->AutoScaleMode = System::Windows::Forms::AutoScaleMode::Font;
            this->ClientSize = System::Drawing::Size(642, 575);
            this->Controls->Add(this->btnPause);
            this->Controls->Add(this->btnStop);
            this->Controls->Add(this->btnPlay);
            this->Controls->Add(this->trackBarProgress);
            this->Controls->Add(this->axWindowsMediaPlayer1);
            this->Name = L"Form1";
            this->Text = L"Aplikacja";
            this->Load += gcnew System::EventHandler(this, &Form1::Form1_Load);
            (cli::safe_cast<System::ComponentModel::ISupportInitialize^  >(this->axWindowsMediaPlayer1))->EndInit();
            (cli::safe_cast<System::ComponentModel::ISupportInitialize^  >(this->trackBarProgress))->EndInit();
            this->ResumeLayout(false);
            this->PerformLayout();
 
        }
#pragma endregion
 
 
private: System::Void Form1_Load(System::Object^  sender, System::EventArgs^  e) {
         }
private: System::Void btnPlay_Click(System::Object^  sender, System::EventArgs^  e) {
             axWindowsMediaPlayer1->Ctlcontrols->play();
         }
private: System::Void btnStop_Click(System::Object^  sender, System::EventArgs^  e) {
             axWindowsMediaPlayer1->Ctlcontrols->stop();
         }
private: System::Void btnPause_Click(System::Object^  sender, System::EventArgs^  e) {
             axWindowsMediaPlayer1->Ctlcontrols->pause();
         }
private: System::Void trackBarProgress_Scroll(System::Object^  sender, System::EventArgs^  e) {
         }
private: System::Void ProgresTimer_Tick(System::Object^  sender, System::EventArgs^  e) {
            int Length = axWindowsMediaPlayer1->currentMedia->duration;
            int Current = axWindowsMediaPlayer1->Ctlcontrols->currentPosition;
            trackBarProgress->Maximum = Length;
            trackBarProgress->Value = Current;
         }
 
};
}
